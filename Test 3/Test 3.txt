Pada test 3 diminta untuk menampilkan pekerjaan nasabah yang dikelompokkan sesuai dengan kelompok usia yang telah ditentukan pada tes ini saya menggunakan database MySQL dengan engine InnoDB dan collation latin1_swedish_ci

query yang saya gunakan adalah sebagai berikut
    SELECT
Pekerjaan,
    CASE
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 14 THEN "01"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 15 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 19 THEN "02"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 20 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 24 THEN "03"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 25 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 29 THEN "04"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 30 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 34 THEN "05"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 35 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 39 THEN "06"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 40 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 44 THEN "07"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 45 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 49 THEN "08"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 50 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 54 THEN "09"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 55 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 59 THEN "10"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 60 THEN "11"
        ELSE "05"
    END AS KelompokUsia,
    COUNT(CASE
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 14 THEN "01"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 15 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 19 THEN "02"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 20 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 24 THEN "03"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 25 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 29 THEN "04"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 30 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 34 THEN "05"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 35 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 39 THEN "06"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 40 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 44 THEN "07"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 45 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 49 THEN "08"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 50 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 54 THEN "09"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 55 AND IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) <= 59 THEN "10"
        WHEN IF (day(TanggalLahir) IS NOT NULL, TIMESTAMPDIFF(YEAR, TanggalLahir, CURDATE()), TIMESTAMPDIFF(YEAR, '19900101', CURDATE())) >= 60 THEN "11"
        ELSE "12"
    END) AS total
FROM `data_nasabah`
GROUP BY
    Pekerjaan,
    KelompokUsia;


dan akan menghasilkan data yang sesuai dengan test_3.jpeg